<!DOCTYPE html>
<html>
<head>
    <title>Birthday Magic ✨</title>
    <style>
        :root {
            --cake-pink: #ff8fab;
            --frosting: #ffffff;
            --ribbon-gold: #ffd700;
            --pastel-pink: #ffd1dc;
        }
        body { 
            margin: 0; 
            background: #fff5f8; 
            overflow: hidden; 
            font-family: 'Segoe UI', Tahoma, sans-serif; 
        }

        /* --- REVERTED INPUT DESIGN --- */
        #overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--pastel-pink); display: flex; flex-direction: column;
            align-items: center; justify-content: center; z-index: 1000; transition: 0.8s;
        }
        #overlay h2 { color: #bf1640; margin-bottom: 20px; font-weight: 300; }
        input {
            padding: 15px; border: none; border-radius: 25px; width: 250px;
            font-size: 1.2rem; text-align: center; outline: none; 
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
        }
        #start-btn {
            margin-top: 20px; padding: 10px 40px; border: none; border-radius: 20px;
            background: white; color: #ff8fab; cursor: pointer; font-weight: bold; font-size: 1rem;
            transition: 0.3s;
        }
        #start-btn:hover { transform: scale(1.05); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }

        /* --- RIBBONS --- */
        .ribbon {
            position: absolute; width: 8px; height: 30px;
            border-radius: 2px; animation: fall linear infinite;
        }
        @keyframes fall {
            0% { transform: translateY(-50px) rotate(0deg); }
            100% { transform: translateY(110vh) rotate(720deg); }
        }

        /* --- AESTHETIC DRIP CAKE --- */
        #cake-container {
            position: absolute; bottom: 120px; left: 50%; transform: translateX(-50%);
            cursor: pointer; z-index: 5;
        }
        .cake {
            width: 220px; height: 130px; background: #ffb7c5;
            border-radius: 15px 15px 5px 5px; position: relative;
            box-shadow: 0 10px 0 #fb8da0;
        }
        .frosting {
            position: absolute; top: -5px; width: 100%; height: 35px;
            background: white; border-radius: 15px 15px 0 0;
            display: flex; justify-content: space-around;
        }
        .drip { width: 30px; height: 40px; background: white; border-radius: 0 0 20px 20px; }
        
        /* Candle */
        .candle {
            width: 14px; height: 60px; background: #add8e6;
            position: absolute; top: -70px; left: 50%; transform: translateX(-50%);
            border-radius: 5px; border-bottom: 2px solid #87ceeb;
        }
        .flame {
            width: 18px; height: 28px; background: #ffcc33;
            position: absolute; top: -32px; left: 50%; transform: translateX(-50%);
            border-radius: 50% 50% 20% 20%;
            box-shadow: 0 0 20px #ffcc33, 0 0 40px #ff9900;
            animation: flicker 0.1s infinite alternate;
        }
        @keyframes flicker { to { transform: translateX(-50%) scale(1.2); opacity: 0.8; } }

        /* --- UI OVERLAYS --- */
        #header { position: absolute; top: 50px; width: 100%; text-align: center; color: #ff8fab; font-size: 3rem; opacity: 0; transition: 1.5s; font-weight: bold; }
        #instruction { position: absolute; top: 140px; width: 100%; text-align: center; color: #ffb7c5; font-size: 1.4rem; opacity: 0; transition: 1s; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 0.4; } 50% { opacity: 1; } }

        /* --- GIFT CARD --- */
        #giftCard {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0);
            width: 350px; background: white; padding: 40px 30px; border-radius: 20px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.15); z-index: 2000; border: 5px solid #ffdae9;
            text-align: center; transition: 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        #giftCard h2 { color: #ff8fab; margin-top: 0; }
        #giftCard p { color: #777; line-height: 1.6; font-size: 1.1rem; }

        /* --- EXIT BUTTON --- */
        #exit-container { position: absolute; bottom: 40px; width: 100%; text-align: center; display: none; }
        .leave-btn {
            padding: 10px 25px; border: 1.5px solid #ccc; background: #ff8fab;;
            color: white; border-radius: 20px; cursor: pointer; font-size: 0.9rem;
            transition: 0.3s;
        }
        .leave-btn:hover { background: #ff8fab; color: white; }
    </style>
</head>
<body>

    <div id="overlay">
        <h2>Enter your name!</h2>
        <input type="text" id="userName" placeholder="Type here...">
        <button id="start-btn" onclick="launch()">Unlock ✨</button>
    </div>

    <div id="header"><span id="displayName"></span></div>
    <div id="instruction">"Blow the candle / click the candle light"</div>

    <div id="cake-container" onclick="blowOut()">
        <div class="candle"><div class="flame" id="flame"></div></div>
        <div class="cake">
            <div class="frosting">
                <div class="drip"></div><div class="drip"></div><div class="drip"></div><div class="drip"></div>
            </div>
        </div>
    </div>

    <div id="giftCard">
        <div style="font-size: 3rem; color: #ff8fab; margin-bottom: 10px;">❤️</div>
        <h2>A Special Note</h2>
        <p>"If(birthday == today) { <br>
            celebrate(); <br>
            eat_cake(); <br>
            print('You are the best friend in my database!'); 
        }<br>
I tried to send you a physical gift, but I couldn't find the 'Real World' API documentation. Hope this digital cake doesn't have any memory leaks!"</p>
        <button id="start-btn" style="background: #ff8fab; color: white;" onclick="closeCard()">Close Letter</button>
    </div>

    <div id="exit-container">
        <button class="leave-btn" onclick="leave()">Leave this place</button>
        <button class="leave-btn" style="margin-left: 10px; background-color: #ffdae9; color: #ff8fab; border: none;" onclick="window.location.href='dining_feast.html';">Discover a Secret Feast ✨</button>
    </div>

    <script>
        function launch() {
            const name = document.getElementById('userName').value;
            if(!name) return;
            document.getElementById('displayName').innerText = "Happy Birthday, " + name + "!";
            document.getElementById('overlay').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('overlay').style.display = 'none';
                document.getElementById('header').style.opacity = '1';
                document.getElementById('instruction').style.opacity = '1';
                createRibbons();
                playMusic();
            }, 800);
        }

        function createRibbons() {
            const colors = ['#ff8fab', '#ffd700', '#add8e6', '#ffffff', '#ffeb3b'];
            for (let i = 0; i < 50; i++) {
                let r = document.createElement('div');
                r.className = 'ribbon';
                r.style.left = Math.random() * 100 + 'vw';
                r.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                r.style.animationDuration = (Math.random() * 3 + 3) + 's';
                r.style.animationDelay = Math.random() * 5 + 's';
                document.body.appendChild(r);
            }
        }

        function blowOut() {
            const flame = document.getElementById('flame');
            if(flame) {
                flame.style.display = 'none';
                document.getElementById('instruction').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('giftCard').style.transform = 'translate(-50%, -50%) scale(1)';
                }, 500);
            }
        }

        function closeCard() {
            document.getElementById('giftCard').style.transform = 'translate(-50%, -50%) scale(0)';
            setTimeout(() => {
                document.getElementById('exit-container').style.display = 'block';
            }, 600);
        }

        function leave() {
            document.body.innerHTML = "<div style='display:flex; height:100vh; align-items:center; justify-content:center; color:#999; font-size:1.5rem;'>Session ended. Have a great birthday!</div>";
        }

        function playMusic() {
            const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            const notes = [261.63, 329.63, 392.00, 523.25]; // Warm C-Major chord
            notes.forEach((f, i) => {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.frequency.value = f;
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                osc.start(audioCtx.currentTime + (i * 0.15));
                gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 2);
            });
        }
    </script>
</body>
</html>